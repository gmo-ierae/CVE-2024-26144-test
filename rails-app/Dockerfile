FROM ruby:3.2.2-bookworm

# bundle install
WORKDIR /app
COPY . /app
RUN bundle install

CMD [ "bash", "-c", "export SECRET_KEY_BASE=$(ruby -e \"require 'securerandom'; puts SecureRandom.hex(64)\"); export RAILS_ENV=production; bundle exec rake db:migrate; bundle exec rake db:seed; bundle exec rails s" ]